import React from 'react'; import styles from './ControlPanel.module.css'; import { useSimulation } from '../../context/SimulationContext';
interface ControlPanelProps { setDisplayNumGpus: (num: number) => void; }
const ControlPanel: React.FC<ControlPanelProps> = ({ setDisplayNumGpus }) => { const { play, pause, nextStep, prevStep, reset, setStrategy, strategy, setNumGpus, numGpus, isPlaying, currentStep, totalSteps } = useSimulation(); const handleGpuChange = (event: React.ChangeEvent<HTMLInputElement>) => { const num = parseInt(event.target.value, 10); setNumGpus(num); /* Context useEffect handles reset */ setDisplayNumGpus(num); }; const handleStrategyChange = (event: React.ChangeEvent<HTMLSelectElement>) => { const newStrategy = event.target.value; setStrategy(newStrategy); /* Context useEffect handles reset */ }; const isSliderDisabled = strategy === 'single'; const handlePlayPause = () => { if (isPlaying) pause(); else play(); };
  return ( <div className={styles.controlPanel}> <h2>Controls</h2> <div> <label htmlFor="strategy-select">Strategy: </label> <select id="strategy-select" value={strategy} onChange={handleStrategyChange}> <option value="single">Single GPU</option> <option value="dp">Data Parallel (DP)</option> <option value="fsdp">FSDP / ZeRO-3</option> </select> </div> <div> <label htmlFor="gpu-slider">Number of GPUs: {numGpus}</label> <input type="range" id="gpu-slider" min={isSliderDisabled ? "1" : "2"} max="8" value={numGpus} onChange={handleGpuChange} className={styles.slider} disabled={isSliderDisabled} /> {isSliderDisabled && <small>(Set Strategy to DP/FSDP)</small>} </div> <div className={styles.simulationControls}> <button onClick={handlePlayPause} disabled={currentStep >= totalSteps}>{isPlaying ? 'Pause' : 'Play'}</button> <button onClick={prevStep} disabled={isPlaying || currentStep <= 0}>Step Backward</button> <button onClick={nextStep} disabled={isPlaying || currentStep >= totalSteps}>Step Forward</button> <button onClick={reset}>Reset</button> </div> <div>Step: {currentStep} / {totalSteps}</div> </div> ); };
export default ControlPanel;
